В шаблонах документов допускается использование изображений в форматах: **BMP** , **JPG** , **JPEG** и **PNG**.


  

Существует два варианта использования изображений в [шаблонах документов](Документы/Шаблоны_документов.md): 


  * **Статический** \- изображение вставляется в шаблон документа и в каждом созданном по этому шаблону документе выводится в неизменном виде.

  * **Динамический** \- изображение привязывается к [ переменной](Документы/Переменные_в_шаблонах_документов.md) типа [ Файлы](Документы/Файлы_-_Тип_поля.md) и в каждом созданном по этому шаблону документе заменяется на соответствующее этой переменной в данный момент времени изображение.


В свою очередь, для использования динамически изменяющихся изображений можно использовать **переменную с дополнительно задаваемыми параметрами** или **переменную, привязанную к "изображению-заглушке"** , которое определяет размер и положение нужного изображения в итоговом документе. Ниже подробно рассмотрены оба варианта. 


## Использование переменной с дополнительными параметрами


В общем случае, для вставки изображения в шаблон документа достаточно добавить в нужное место (строку, ячейку) шаблона название переменной, которая в каждом конкретном случае будет содержать нужный файл изображения: 


![Vr9SjJ.png](images/Vr9SjJ.png)


  

Для управления размером и положением изображения в итоговом файле применяются следующие параметры: 


  * Для шаблонов в формате MS Word есть возможность в явном виде задавать **размер вставляемого изображения**.


    Синтаксис переменной: 


    {{НазваниеПеременной::РАЗМЕР_Х_ОСЬхРАЗМЕР_Y_ОСЬ}}


    Пример использования переменной с этим параметром: 


    {{Задача.Файл.Фото сотрудника::200x300}}


  * Для шаблонов в формате MS Word есть возможность в явном виде выбрать вариант обтекания изображения текстом. Для этого используются дополнительный параметр переменной **Обтекание** :


    Примеры использования: 


    {{Системные.Файл::50x50;обтекание=вокруг рамки}}


    


    {{Системные.Файл::50x50;обтекание=перед текстом}}


    


    {{Системные.Файл::50x50;обтекание=сверху и снизу}}


    Используемый формат: 


  * до разделителя :: (два двоеточия) идет имя переменной;

  * 50x50 - ширина и высота изображения в сформированном по шаблону документе;

  * обтекание - выбирается вариант обтекания изображения текстом.


    **Обратите внимание:** в примерах выше используется сразу два параметра, разделенных точкой с запятой: размер изображения и обтекание изображения текстом.


  * Для шаблонов в формате MS Word дополнительно доступны атрибуты **МаксВысота** и **МаксШирина**. При использовании такого атрибута соответствующее ему измерение изображения в итоговом файле будет иметь установленный размер, а второе измерение примет пропорциональное значение.


    Пример использования переменной с дополнительным атрибутом: 


    {{Системные.Файл::МаксШирина=150}}


    Результат: у вставленного изображения в итоговом документе ширина будет установлена в 150 пикселей, а высота подогнана пропорционально.


  * В шаблонах формата MS Excel изображение по умолчанию "заполняет" ячейку которую занимает переменная, поэтому ее размер и пропорции будут определяться размером отведенной под изображение ячейки. Допускается использование объединенных ячеек.


    Для вставки оригинального размера изображения используется атрибут "оригинал". Пример использования переменной с этим атрибутом:


    


    {{Задача.Файл.Фото сотрудника::оригинал}}


## Использование переменной с изображением-заглушкой


В этом варианте в шаблон документа вставляется заготовка изображения, которая определяет размер и положения нужного изображения в итоговом файле. Это вариант не требует использования параметров, так как все они настраиваются визуально, путем перемещения в шаблоне документа изображения-заглушки и изменения его размера до желаемого. Привязка изображения-заглушки к переменной происходит путем указания переменной в качестве имени этого изображения в шаблоне документа. 


Для использования этого варианта необходимо: 


  * Открыть шаблон документа в бесплатном пакете [LibreOffice](https://ru.libreoffice.org/).

  * Вставить на желаемое место в шаблоне изображение нужного размера.

  * Щелкнуть на нем правой кнопкой мыши и из появившегося меню выбрать пункт:


    


  * для шаблона MS Excel **Имя** (см. [ пример](Документы/Печать_и_подпись_в_шаблонах_документов.md))


    


  * для шаблона MS Word **Свойства** :


![Jn3PTc.png](images/Jn3PTc.png)


  


    


    и в появившемся окне перейти на вкладку **Параметры** , где расположено поле **Описание**. Добавьте в него название переменной, соответствующей полю, которое содержит изображение:


![yx5Z6n.png](images/yx5Z6n.png)


  


  * При формированию документа по оформленному таким образом шаблону, изображение окажется в том же (относительно других элементов) месте, которое вы указали в шаблоне.


  

Полезная информация для этого варианта использования: 


  * При формировании документа по шаблону, изображение в шаблоне заменяется на изображение, загруженное в поле, которое вы указали в имени. Поэтому неважно, какое изображение будет добавлено в сам файл шаблона - оно играет лишь роль "заглушки" для изображения, которое реально будет вставлено в документ.

  * Если в имени изображения в файле шаблона указано имя несуществующего поля или в это поле не загружено изображение, в итоговом файле изображения не будет.

  * При формировании документа в него будет вставлено изображение того размера, который был указан в шаблоне. То есть, если в шаблоне у вас вставлено изображение печати 5*5 см, а реальное загруженное в общее поле "Печать" изображение имеет размеры 4*4 см, то в итоговом файле оно будет растянуто до размеров 5*5 см.


## Использование одного изображения несколько раз


Если вам необходимо вставить одно изображение (например, печать или подпись) несколько раз в один шаблон документа, используйте переменную с дополнительным параметром. Например: 


**{{Общие.Печать::Метка1}}**


где в качестве параметра **Метка1** указывается любой текст, отличающийся для каждого использования переменной в рамках одного шаблона (например, Метка1, Метка2 и т.д.). 


Этот дополнительный параметр, добавленный после символов :: (два двоеточия) можно использовать как в переменной с дополнительно задаваемыми параметрами, так и в переменной, привязанной к "изображению-заглушке". 


## Полезные ссылки


  * [Вывод в документ всех файлов задачи](Задачи/Вывод_в_документ_всех_файлов_задачи.md)

  * [Печать и подпись в шаблонах документов](Документы/Печать_и_подпись_в_шаблонах_документов.md)
