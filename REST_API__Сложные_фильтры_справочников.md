Сложные фильтры в [REST API](REST_API.md "REST API") ПланФикса применяются в методе «/directory/{id}/entry/list» при получении записей справочников. Фильтры справочников задаются следующим набором параметров: 


  * **type** — числовой идентификатор фильтра.

  * **operator** — оператор фильтра, одно из значений списка (equal, notequal, gt, lt). У разных фильтров могут быть разные допустимые операторы.

  * **value** — значение фильтра, в зависимости от типа фильтра может быть строкой, числом или сложным объектом.

  * **field** — идентификатор пользовательского поля справочника, по которому выполняется фильтр.


  

Пример запроса получения списка записей справочника с передачей нескольких фильтров, по пользовательскому полю типа «Дата» и пользовательскому полю типа «Сотрудник» (используется логика И): 


  


    

    

    {

      "offset": 0,

      "pageSize": 100,

      "fields": "directory,parentKey,key,3,5",

      "filters": [

        {

          "type": 6103,

          "field": 3,

          "operator": "equal",

          "value": {

            "dateType": "otherRange",

            "dateFrom": "15-12-2022",

            "dateTo": "17-12-2022"

          }

        },

        {

          "type": 6109,

          "field": 5,

          "operator": "equal",

          "value": "user:50"

        }

      ]

    }

    


  


Тип | Название | Операторы | Формат value   

---|---|---|---  

6103 | Поле справочника типа Дата  | 


  * equal

  * notequal

  * gt

  * lt


| Объект : 

    

    

     

    "value": {

        "dateType": string,

        "dateValue": string,

        "dateFrom": string,

        "dateTo": string

    }

    


  

dateType принимает следующие значения: 


  * today - сегодня

  * yesterday - вчера

  * tomorrow - завтра

  * thisWeek - текущая неделя

  * lastWeek

  * nextWeek

  * thisMonth

  * lastMonth

  * nextMonth

  * last - последние n дней, n передается в dateValue

  * next - следующие n дней, n передается в dateValue

  * in - через n дней, n передается в dateValue

  * otherDate - точная дата, дата передается в формате дд-мм-гггг в dateFrom

  * otherRange - точный период, даты передаются в формате дд-мм-гггг в dateFrom и dateTo

  * otherDate_withTime - точная дата-время, дата передается в формате "дд-мм-гггг чч:мм" в dateFrom

  * otherRange_withTime - точный период с заданным временем, даты передаются в формате "дд-мм-гггг чч:мм" в dateFrom и dateTo


Даты считаются переданными в часовом поясе сотрудника, от имени которого сделан запрос. Примеры: 

    

    

    "value": {

        "dateType": "thisWeek"

    }

    

    

    

    "value": {

        "dateType": "otherRange",

        "dateFrom": "01-12-2022",

        "dateTo": "06-12-2022"

    }

    

    

    

    "value": {

        "dateType": "otherDate_withTime",

        "dateFrom": "30-12-2022 12:00",

    }

      

  

6108 | Поле справочника типа Контакт  | 


  * equal

  * notequal


| string - номер сотрудника/контакта/группы с префиксом. Например: “user:1”, “contact:5”, “group:3”   

6109 | Поле справочника типа Сотрудник   

6110 | Поле справочника типа Контрагент   

6112 | Поле справочника типа Группа, сотрудник, контакт   

6113 | Поле справочника типа Список сотрудников  | 


  * equal

  * notequal


| string - осуществляется фильтр содержит / не содержит   

6101 | Поле справочника типа Строка  | 


  * equal

  * notequal

  * have

  * nothave


| string - осуществляется фильтр равно / не равно / содержит / не содержит   

6102 | Поле справочника типа Число  | 


  * equal

  * notequal

  * gt

  * lt


| int   

6105 | Поле справочника типа Чекбокс  | 


  * equal

  * notequal


| int - 1/0   

boolean   

6005 | Является ли запись архивной   

6106 | Поле справочника типа Список  | 


  * equal

  * notequal


| string   

6107 | Поле справочника типа Запись справочника  | 


  * equal

  * notequal


| int - идентификатор записи   

6114 | Поле справочника типа Набор записей справочника  | 


  * equal

  * notequal


| int — идентификатор записи, для условия по нескольким записям — идентификаторы через ; (точку с запятой)   

6115 | Поле справочника типа Задача  | 


  * equal

  * notequal


| int — номер задачи   

6117 | Поле справочника типа Проект  | 


  * equal

  * notequal


| int — номер проекта   

6003 | Запись входит в группу справочника  | 


  * equal

  * notequal


| int - идентификатор группы справочника   

6006 | Запись справочника  | 


  * equal

  * notequal


| int - идентификатор записи или массив идентификаторов для условия по нескольким идентификаторам (ИЛИ)
