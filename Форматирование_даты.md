В шаблонах [задач](Переменные_в_шаблонах_задач.md "Переменные в шаблонах задач") и [документов](Переменные_в_шаблонах_документов.md "Переменные в шаблонах документов") ПланФикса можно использовать различные переменные, в том числе даты и времени. Таким переменным можно задать нужный формат для отображения. Шаблон переменной с форматированием выглядит так: 


**{{Задача.Дата::ФорматироватьДату=Формат}}** , где Формат — это шаблон вывода даты. 


  

На примере даты **3 Июля 1996 года 14 часов 14 минут** в таблицах ниже представлены паттерны для форматирования дат в переменных. 


Формат  | Описание  | Примеры   

---|---|---  

y  | выводит год (4 цифры)  | 1996   

yy  | выводит год (2 цифры)  | 96   

yyyy  | выводит год (4 цифры)  | 1996   

M  | месяц в году, без ведущего нуля  | 7, 10   

MM  | месяц в году с ведущим нулём  | 07, 10   

MMM  | месяц в году сокращением  | июл.   

MMMM  | месяц в году с окончанием  | июля   

d  | день в месяце без ведущего нуля  | 3, 15   

dd  | день в месяце с ведущим нулем  | 03, 15   

E  | День недели, сокращенный  | ср   

EEEE  | День недели, полный  | среда   

a  | AM / PM маркер для даты  | PM   

H  | час в формате 0-23 без ведущего нуля  | 3, 14   

HH  | час в формате 0-23 с ведущим нулем  | 03, 14   

h  | часы в представлении AM / PM (1-12)  | 2   

hh  | часы в представлении AM / PM (1-12)  | 02   

m  | минута часа без нуля  | 4, 30   

mm  | минута часа с нулём  | 04, 30   

s  | секунды  | 5, 55   

ss  | секунды с ведущим нулём  | 05, 55   

S  | миллисекунды (1 цифра)  | 3   

SS  | миллисекунды (2 цифры)  | 35   

SSS  | миллисекунды (3 цифры)  | 359   

L  | месяц, без ведущего нуля  | 7   

LL  | месяц c ведущим нулём  | 07   

LLL  | месяц названием сокращенно  | нояб.   

LLLL  | месяц названием  | ноябрь   

w  | номер недели в году  | 27   

W  | номер недели в месяце  | 1   

D  | день от начала года  | 185   

  

## Примеры форматирования дат


В таблице для примера используется переменная пользовательского поля типа «Дата». 


Переменная  | Результат   

---|---  

{{Задача.Дата::ФорматироватьДату=dd/MM/yy}}  | 03/06/96   

{{Задача.Дата::ФорматироватьДату=dd MMM yyyy}}  | 03 июл. 1996   

{{Задача.Дата::ФорматироватьДату=yyyy-MM-dd}}  | 1996-06-03   

{{Задача.Дата::ФорматироватьДату=dd-MM-yyyy h:mm a}}  | 03-06-1996 2:14 AM   

{{Задача.Дата::ФорматироватьДату=dd-MM-yyyy HH:mm:ss}}  | 03-06-1996 14:14:28   

{{Задача.Дата::ФорматироватьДату=yyyy-MM-dd HH:mm:ss.SSS}}  | 1996-06-03 14:14:28.954   

{{Задача.Дата::ФорматироватьДату=yyMMddHHmmssSSS}}  | 960603141428954   

{{Задача.Дата::ФорматироватьДату=EEEE, hh a}}  | среда, 02 PM   

  

## Важно


  * Формат даты в переменной указывается только английскими буквами.

  * При вставке переменной типа ДАТА с форматированием в ячейку Excel к ней применяется форматирование. Если для переменной нет форматирования, то будет использоваться форматирование конечной ячейки. Ячейка, в которую вставляется форматирование, в конечном итоге будет типа ДАТА.
