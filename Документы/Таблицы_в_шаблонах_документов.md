Для вставки в формируемый по [ шаблону](Документы/Шаблоны_документов.md) документ табличной части с перечислением произвольного количества объектов (товаров, услуг и т.п.) обычно используется [ аналитика](Аналитика/Аналитика.md). Происходит это следующим образом: 


  * В шаблон добавляется таблица с нужным заголовком и одной строкой

  * В ячейки этой строки заносятся названия переменных, соответствующих нужному полю аналитики, в которой хранятся данные


**Пример:** табличная часть в шаблоне счета: 


![5kszmw.jpg](images/5kszmw.jpg)


  

Переменные для заполнения табличной части перечислены в списке, доступном в разделе Документы — [Шаблоны документов](Документы/Переменные_в_шаблонах_документов.md). 


Для каждой аналитики помимо списка ее полей доступны две универсальные переменные: "Порядковый номер записи" и "!количество": 


![KeQbrg.jpg](images/KeQbrg.jpg)


  


  * **Порядковый номер записи** — выводит номер строки таблицы. Ее удобно поместить в первую ячейку таблицы и использовать для автонумерации.

  * **!количество** — выводит общее количество строк аналитики, которые войдут в документ.


## Важно


Существует различие в формировании документа по шаблонам, созданным в MS Word и MS Excel: 


  * при формировании документа по шаблону MS Word, строки будут размножены только в том случае, если переменная вставлена в таблицу;

  * при формировании документа по шаблону MS Excel, строки будут размножены в любом случае, вне зависимости от места, куда была вставлена переменная.


## Дополнительная информация


  * Использование переменных, связанных с аналитикой, а также ряда других переменных, приводят к [ автоматическому размножению строк](Автоматизация/Автоматическое_размножение_строк_документа.md) при формированию документа по шаблону. Именно это позволяет получать документы с табличной частью произвольной длины, которая зависит от количества строк аналитики в задаче или комментарии, по которым формируется документ.

  * Так как размер документа изменяется в зависимости от количества строк в таблице, существует специальный механизм вставки [ печати, подписи и других изображений](Документы/Печать_и_подпись_в_шаблонах_документов.md), который обеспечивает их размещение в нужном месте итогового документа.

  * Для того, чтобы в шаблоне формата Excel ячейка автоматически подстраивала свою высоту в зависимости от длины текста в переменной, необходимо соблюсти несколько условий, при этом важно помнить — при конвертации в PDF автовысота ячейки работать не будет: 

    * для ячейки активируйте опцию "Перенос текста" в Excel.

    * в любом столбце строки добавьте текст **{{автовысота}}**.

    * ячейка не должна содержать объединение.

  * При помощи условного форматирования, в табличной части документа можно [ выводить строки с чередующимся фоном](Документы/Шаблоны__Выделение_строк_полосами_фона.md):

  * Вы можете [ вывести в документ все файлы, прикрепленные к задаче](Задачи/Вывод_в_документ_всех_файлов_задачи.md)
