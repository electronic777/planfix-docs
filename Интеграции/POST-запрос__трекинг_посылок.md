Благодаря [HTTP-запросам](Интеграции/HTTP-запросы.md) в ПланФиксе можно отслеживать посылки транспортных компаний: 


  * СДЭК

  * Новая Почта


  


## СДЭК


Настроим получение информации о номере заказа через аутентификацию по токену, используя [API](https://www.cdek.ru/ru/integration#for_developers) компании СДЭК. 


Схема работы: 

    

    

    1. Отправка предварительного POST-запроса

    2. Получение токена в ответ

    3. Добавление токена в заголовок основного запроса

    4. Отправка основного запроса.

    


  


  * **Шаг № 1** — отправляем предварительный запрос в СДЭК, проходим аутентификацию:


![qKMEOZ.png](images/qKMEOZ.png)


  


  * **Шаг № 2** — разбираем ответ на предварительный запрос и получаем токен. Отправляем в СДЭК основной запрос для получения информации о номере заказа:


![j5v4Om.png](images/j5v4Om.png)


  * _Обратите внимание, полученный токен добавлен в заголовок основного запроса._

  * _Получить информацию можно и по трек-номеру: https://api.cdek.ru/v2/orders?cdek_number={{Задача.Трек-номер}}_


  


  * **Шаг № 3** — разбираем полученную информацию от СДЭК о номере заказа и добавляем её в нужное поле:


![biFKYv.png](images/biFKYv.png)


  


## Новая Почта


Получаем статус посылки от украинской транспортной компании «Новая Почта». 


  * Добавляем в шаблон задачи два поля типа строка: «ТТН» и «Номер телефона».

  * Настраиваем кнопку, используя [API «Новой Почты»](https://devcenter.novaposhta.ua/docs/services/556eef34a0fe4f02049c664e/operations/55702cbba0fe4f0cf4fc53ee):


![f0AHu5.png](images/f0AHu5.png)


  


    

    

    {

        "modelName": "TrackingDocument",

        "calledMethod": "getStatusDocuments",

        "methodProperties": {

            "Documents": [

                {

                    "DocumentNumber": "{{Задача.ТТН}}",

                    "Phone":"{{Задача.Номер телефона}}"

                }

            ]

        }

    }

    


  


  * Средствами ПланФикса разбираем ответ от «Новой Почты»:


![rLwPEr.png](images/rLwPEr.png)


  

В итоге в задаче видим дату и статус отправления: 


![1ClUzS.png](images/1ClUzS.png)


  


## Дополнительная информация


  * [Пост про POST](https://planfix.com/ru/blog/post/)

  * [Разбор ответов на HTTP-запросы](https://planfix.com/ru/blog/razbor-otvetov-na-http-zaprosy/)
